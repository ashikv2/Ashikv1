// delay helper (same style as murgi)
const delay = (ms) => new Promise(res => setTimeout(res, ms));

// active war storage (like activeMurgi)
const activeWar = new Map();

module.exports = {
  config: {
    name: "war",
    version: "1.0",
    author: "Xemon",
    role: 2,
    category: "texts",
    guide: {
      vi: "Not Available",
      en: "cpx @(mention) | off"
    } 
  },

  onStart: async function ({ api, event, args }) {
    const { threadID } = event;

    // ЁЯФ┤ OFF (exact murgi logic)
    if (args[0] && args[0].toLowerCase() === "off") {
      if (activeWar.has(threadID)) {
        activeWar.set(threadID, false);
        return api.sendMessage("тЭМ WAR OFF", threadID);
      }
      return api.sendMessage("тЪая╕П WAR is not running.", threadID);
    }

    const mention = Object.keys(event.mentions)[0];
    if (!mention)
      return api.sendMessage(
        "Need to tag 1 friend whome you want to scold with bad words",
        threadID
      );

    const name = event.mentions[mention];
    const arraytag = [{ id: mention, tag: name }];

    // ЁЯЯв ON
    activeWar.set(threadID, true);
    api.sendMessage("ЁЯФе WAR ON", threadID);

    // safe sender (OFF рж╣рж▓рзЗ ржЖрж░ ржкрж╛ржарж╛ржмрзЗ ржирж╛)
    const a = async (data) => {
      if (!activeWar.get(threadID)) return;
      return api.sendMessage(data, threadID);
    };

    try {
      // ===== ORIGINAL MESSAGES (UNCHANGED) =====

      await delay(3000);  await a({body: "рждрж░ ржорж╛рж░ ржнрзЛржжрж╛рзЯ ржкрж╛ржмрзНрж▓рж┐ржХ ржЯрзЯрж▓рзЗржЯ ЁЯе╡рждрж░ ржорж╛рзЯрзЗрж░ ржнрзБржжрж╛рждрзЗ ржкрзЛржХрж╛ ЁЯе╡рждрж░ ржмрж╛ржкрзЗрж░ ржзрзЛржи рждрж░ ржмржЙрзЯрзЗрж░ ржнрзЛржжрж╛рждрзЗржжрж┐ржорзБ " + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржЖржмрж╛рж▓ ржЪрзЛржжрж╛ ржХрж╛ржирзНржжрзЗ ржлрж╛рж▓рж╛ржЗрзЯрж╛ рждрж░ ржорж╛рзЯрзЗрж░рзЗ ржЪрзБржжрж┐ЁЯе╡ЁЯе╡" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржнрзБржжрж╛рж░ ржмрзЗржЯрж╛  рждрж░ ржорж╛ ржПрж░ ржнрзБржжрж╛рзЯ ржзрж╛ржи ржЫрзЬрж╛ржЗрзЯрж╛ ржЪрзЬрзБржЗ ржжрж┐рзЯрж╛ ржЦрж╛ржУрзЯрж╛ржорзБтЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╣рзЛржЧрж╛рж░ ржнрж┐рждрж░рзЗ ржнржЗрзЬрж╛ ржжрж┐ржорзБтАжржарзНржпрж╛ржБржЩ ржХрж╛ржЗржЯрзНржЯрж╛ ржкрзБржЯржХрж┐ ржжрж╛ ржнржЗрж░рж╛ ржжрзБржо! рж╣рж╛рж▓рж╛ рж▓рзНржпрж╛ржУрзЬрж╛ ржЪрзЛржжрж╛" + " " + name, mentions: arraytag});
      await delay(3000);  await a({body: "рж╣рзЛржЧрж╛рж░ ржнрж┐рждрж░рзЗ ржнржЗрзЬрж╛ ржжрж┐ржорзБтАжржарзНржпрж╛ржБржЩ ржХрж╛ржЗржЯрзНржЯрж╛ ржкрзБржЯржХрж┐ ржжрж╛ ржнржЗрж░рж╛ ржжрзБржо! рж╣рж╛рж▓рж╛ рж▓рзНржпрж╛ржУрзЬрж╛ ржЪрзЛржжрж╛ЁЯТЛ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╢рзБрзЯрзЛрж░рзЗрж░ ржмрж╛ржЪрзНржЪрж╛ ржХрзБрждрзНрждрж╛рж░ ржмрж╛ржЪрзНржЫрж╛ рж╣рж╛рж░рж╛ржорж┐рж░ ржмрж╛ржЪрзНржЪрж╛ рж╣рж╛рж░рж╛ржорж┐ рж╣рж╛рж░рж╛ржоржЬрж╛ржжрж╛ рж╣рж╛рж░рж╛ржоржЦрзЛрж░ ржЦрж╛ржирзНржХрж┐ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛ЁЯШн" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржХрж╛ржирзНржжрзЗ ржлрж╛рж▓рж╛ржЗрзЯрж╛ рждрж░ ржорж╛рзЯрзЗрж░рзЗ ржЪрзБржжрж┐I" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржХрж╛ржирзНржжрзЗ ржлрж╛рж▓рж╛ржЗрзЯрж╛ рждрж░ ржорж╛рзЯрзЗрж░рзЗ ржЪрзБржжрж┐ ЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржзрзЛржи ржХрж╛ржЗржЯрзНржЯрж╛ ржХрзБрждрзНрждрж╛ ржжрж┐рзЯрж╛ ржЦрж╛ржУрзЯрж╛ржорзБ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛржЧрзЛрж░рзЗ ржлрж╛рж╕рж┐рждрзЗ рж▓ржЯржХрж╛ржЗрзЯрж╛ ржЪрзБржжржорзБ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛржЧрзЛрж░ ржзрзЛржи ржЯрж╛ржЗржирж╛ рждрзЛржЧрзЛрж░ ржкрж┐ржЫржи ржжрж┐рзЯрж╛ ржврзБржХрж╛ржорзБЁЯТЛ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: ". ржЬржВ ржзрж░рж╛ рж▓рзЛрж╣рж╛ ржжрж┐рзЯрж╛ ржкрж╛ржХрж┐рж╕рзНрждрж╛ржирзЗрж░ ржорж╛ржиржЪрж┐рждрзНрж░ ржмрж╛ржирж╛ржЗрзНрзЯрж╛ рждрзЛржжрзЗрж░ ржкрж┐ржЫржи ржжрж┐рзЯрж╛ ржврзБржХрж╛ржорзБ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ рж╢рж┐рж░рж┐рж╖ ржХрж╛ржЧржЬ ржжрж┐рзЯрж╛ ржШржЗрж╖рж╛ ржжрж┐ржорзБред" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ рж╢рж┐рж░рж┐рж╖ ржХрж╛ржЧржЬ ржжрж┐рзЯрж╛ ржШржЗрж╖рж╛ ржжрж┐ржорзБредЁЯШнЁЯТЛ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ ржмрзЛржорзНржмрж╛ржЗ ржорж░рж┐ржЪ ржжрж┐рзЯрж╛ ржЪрзБржжрж╛ржорзБред " + " " + name, mentions: arraytag});
      await delay(33000); await a({body: "рждрж░ ржмрж╛ржкрзЗрж░ ржкрзБржЯржХрж┐рж░ ржлрзБржЯрж╛ ржжрж┐рзЯрж╛ ржХрж╛ржбрж▓ ржврзБржХрж╛ржорзБред" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржмрзМрзЯрзЗрж░ ржнрзЛржжрж╛рзЯ ржорж╛ржЧрзБрж░ ржорж╛ржЫ ржЪрж╛рж╖ ржХрж░рзБржоред " + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╣рж╛рждрж┐рж░ рж▓рзНржпрж╛ржУрзЬрж╛ ржжрж┐рзЯрж╛ рждрж░ ржорж╛рзЯрзЗрж░рзЗ ржЪрзБржжрзБржоредЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ ржЫрж┐рж▓рзНрж▓рж╛ рж▓ржмржг рж▓рж╛ржЧрж╛рзЯ ржжрж┐ржорзБред" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛрж░ ржорж╛ ржмрзЛржи ржмржЙ рж░рзЗ ржПржХрж╕рж╛ржерзЗ ржПржХржЯрж╛ ржХржиржбржо ржжрж┐рзЯрзЗ ржЪрзБржжрж┐ЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ ржЫрж┐рж▓рзНрж▓рж╛ рж▓ржмржг рж▓рж╛ржЧрж╛рзЯ ржжрж┐ржорзБред" + " " + name, mentions: arraytag});
      await delay(416000);await a({body: "ржЦрж╛ржВржХрж┐рж░ ржкрзЛрж▓рж╛ рждрзЛрж░ ржорж╛ рж░рзЗ ржЧрж╛ржЫ ржПрж░ рж╕рж╛ржерзЗ ржмрзЗржзрзЗ ржнрзБржжрж╛рж░ ржоржзрзНржпрзЗ рждрж╛рж▓ржЧрж╛ржЫ ржврзБржХрж┐рзЯрзЗ ржЪрзБржжрж┐ЁЯе╡ " + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржмрзЗрж╕рзНржпрж╛ ржХржиржбржо ржлрж╛ржЯрж╛ ржнрзБржжрж╛ ржЫрж┐рзЬрж╛ рждрзЛрж░ ржорж╛ рж░рзЗ рж╕рзЛржлрж╛рзЯ ржлрж╛рж▓рж╛рзЯрж╛ ржЪрзБржжрж┐ЁЯдаЁЯлА" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржмрзЗрж╕рзНржпрж╛ ржХржиржбржо ржлрж╛ржЯрж╛ ржнрзБржжрж╛ ржЫрж┐рзЬрж╛ рждрзЛрж░ ржорж╛ рж░рзЗ рж╕рзЛржлрж╛рзЯ ржлрж╛рж▓рж╛рзЯрж╛ ржЪрзБржжрж┐" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛ржХрзЗ ржЖрж▓ржорж╛рж░рж┐рж░ рж╕рж╛ржерзЗ ржмрзЗржБржзрзЗ ржЪрзБржжрж┐ ржпрж╛рждрзЗ ржЖрж░рж╛ржорзЗ ржЪрзБржжрж╛ ржпрж╛рзЯ" + " " + name, mentions: arraytag});
      await delay(4000);  await a({body: "ржЖржУржпрж╝рж╛ржорзАрж▓рзАржЧ ржПрж░ рж╕ржнрж╛ржкрждрж┐ ржмржЩрзНржЧржмрзАрж░ ржХрж╛ржжрзЗрж░ рж╕рж┐ржжрзНржжрж┐ржХрзА ржмрзАрж░ржЙрждрзНрждржо ржмрзАрж░ржмрж┐ржХрзНрж░ржо ржПрж░ ржнрж╛рж░рзНрж╕ржи ржЕрзНржпрж╛ржирзНржбрзНрж░ржпрж╝рзЗржб ржП рж░рзЗржЦрзЗ рждрзБрж░ ржорж╛ржХрзЗ рж▓рзЗржВржЯрж╛ ржХрж░рзЗ рждрзЛрж░ ржорж╛рж░ ржнрзЛржжрж╛ржпрж╝ ржЖржЧрзБржи ржжрж┐ржмрзЛ ржкрж╛рж░рж▓рзЗ ржарзЗржХрж╛ржЗрж╕" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржмрж┐ржжрзБрзО ржПрж░ ржХрж╛рж░рзЗржирзНржЯ рждрж░ ржорж╛ рж░ ржнрзБржжрж╛рзЯ ржкрзНрж░ржмрзЗрж╢ ржХрж░рж┐рзЯрзЗ ржЗрж▓рзЗржХржЯрзНрж░ржирж┐ржХ рж╕рж░рзНржЯ ржжрж┐рзЯрзЗ рждрж░ ржорж╛ржХрзЗ ржЪрзБржжрж┐ЁЯЩАтЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛрж░ ржорж╛ рж░рзЗ ржорж╛рж╕рж┐ржХ ржЖржЯржХрж╛ржЗрзЯрж╛ ржорзЗрж░рзЗ ржлрзЗрж▓ржмрзЛЁЯШШ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╕рж┐ржи ржжрзЗ ржнрж╛ржЪрзБрзЯрж╛рж▓ ржПрж░ ржлрж╛ржкрж░ржмрж╛ржЬ ржЪрзБржжрж╛рж╕ рж░рж┐рзЯрзЗрж▓ рж▓рж╛ржЗржлрзЗ ржд ржмрж╛рж╕рж╛ ржерзЗржХрзЗ ржмрзЗрж░ рж╣рж╕ ржирж╛ рждрж░ ржорж╛ржХрзЗ рзиржЯрж╛ржХрж╛рж░ ржХржирзНржбржо ржжрж┐рзЯрзЗ ржЪрзБржжрзЗЁЯШ╗" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛрж░ ржорж╛ рж░рзЗ ржорж╛рж╕рж┐ржХ ржЖржЯржХрж╛ржЗрзЯрж╛ ржорзЗрж░рзЗ ржлрзЗрж▓ржмрзЛтЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рж░рзЗ ржкржжрзНржорж╛ рж╕рзЗрждрзБрж░ рзнржирж╛ржорзНржмрж╛рж░ ржкрж┐рж▓рж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рж╣рж╛ржд ржкрж╛ ржмрзЗржжрзЗ ржХрж╛рж▓рж╛ ржХрзБрждрзНрждрж╛ ржжрж┐рзЯрзЗ ржЪрзБржжрж╛ржЗЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛрж░ ржорж╛ рж░рзЗ ржорж╛рж╕рж┐ржХ ржЖржЯржХрж╛ржЗрзЯрж╛ ржорзЗрж░рзЗ ржлрзЗрж▓ржмрзЛтЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╣рзЛржЧрж╛рж░ ржнрж┐рждрж░рзЗ ржнржЗрзЬрж╛ ржжрж┐ржорзБтАжржарзНржпрж╛ржБржЩ ржХрж╛ржЗржЯрзНржЯрж╛ ржкрзБржЯржХрж┐ ржжрж╛ ржнржЗрж░рж╛ ржжрзБржо! рж╣рж╛рж▓рж╛ рж▓рзНржпрж╛ржУрзЬрж╛ ржЪрзЛржжрж╛" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╢рзБрзЯрзЛрж░рзЗрж░ ржмрж╛ржЪрзНржЪрж╛ ржХрзБрждрзНрждрж╛рж░ ржмрж╛ржЪрзНржЫрж╛ рж╣рж╛рж░рж╛ржорж┐рж░ ржмрж╛ржЪрзНржЪрж╛ рж╣рж╛рж░рж╛ржорж┐ рж╣рж╛рж░рж╛ржоржЬрж╛ржжрж╛ рж╣рж╛рж░рж╛ржоржЦрзЛрж░ ржЦрж╛ржирзНржХрж┐ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛ЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "ржЖржмрж╛рж▓ ржЪрзЛржжрж╛ ржХрж╛ржирзНржжрзЗ ржлрж╛рж▓рж╛ржЗрзЯрж╛ рждрж░ ржорж╛рзЯрзЗрж░рзЗ ржЪрзБржжрж┐ЁЯе╡ЁЯе╡" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рж░ ржнрзЛржжрж╛рзЯ ржкрж╛ржмрзНрж▓рж┐ржХ ржЯрзЯрж▓рзЗржЯ ЁЯе╡рждрж░ ржорж╛рзЯрзЗрж░ ржнрзБржжрж╛рждрзЗ ржкрзЛржХрж╛ ЁЯе╡рждрж░ ржмрж╛ржкрзЗрж░ рж╣рзЛрж▓ рждрж░ ржмржЙрзЯрзЗрж░ ржнрзЛржжрж╛рждрзЗржжрж┐ржорзБЁЯдатЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рж╢рзБрзЯрзЛрж░рзЗрж░ ржмрж╛ржЪрзНржЪрж╛ ржХрзБрждрзНрждрж╛рж░ ржмрж╛ржЪрзНржЫрж╛ рж╣рж╛рж░рж╛ржорж┐рж░ ржмрж╛ржЪрзНржЪрж╛ рж╣рж╛рж░рж╛ржорж┐ рж╣рж╛рж░рж╛ржоржЬрж╛ржжрж╛ рж╣рж╛рж░рж╛ржоржЦрзЛрж░ ржЦрж╛ржирзНржХрж┐ ржорж╛ржЧрж┐рж░ ржкрзЛрж▓рж╛тЭд" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрзЛржЧрзЛрж░рзЗ ржлрж╛рж╕рж┐рждрзЗ рж▓ржЯржХрж╛ржЗрзЯрж╛ ржЪрзБржжржорзБ" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржорж╛рзЯрзЗрж░ ржнрзЛржжрж╛ рж╢рж┐рж░рж┐рж╖ ржХрж╛ржЧржЬ ржжрж┐рзЯрж╛ ржШржЗрж╖рж╛ ржжрж┐ржорзБред" + " " + name, mentions: arraytag});
      await delay(2000);  await a({body: "рждрж░ ржмрж╛ржкрзЗрж░ ржкрзБржЯржХрж┐рж░ ржлрзБржЯрж╛ ржжрж┐рзЯрж╛ ржХрж╛ржбрж▓ ржврзБржХрж╛ржорзБред" + " " + name, mentions: arraytag});
      await delay(0);     await a({body: "ASHIK THE GREAT EXIT!!ЁЯШ╛ЁЯеАЁЯдг" + " " + name, mentions: arraytag});

      activeWar.delete(threadID);
    } catch (e) {
      console.error(e);
      activeWar.delete(threadID);
    }
  }
};